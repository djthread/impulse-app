<template>
  <require from="./components/eventsListing"></require>
  <require from="./components/episodesListing"></require>
  <section class="hero">
    <div class="hero-overlay">
      <div class="hero-info">
        Impulse Detroit is a ring of recurring DJ events around the city. Tune in live for the video, or subscribe and listen to the podcasts.
      </div>
    </div>
  </section>

  <section class="main dropshadow">
    <div class="content">
      <div class="section-left">
        <div class="videowrapper">
          <video id="thevideo" class="video-js vjs-default-skin embed-responsive-item"
           controls preload="auto" poster="/images/poster.jpg">
            <source src="rtmp://techtues.net/live/techno" type="rtmp/flv">
          </video>
        </div>
        
        <div class="infoline">${state.infoline}</div>
      </div>

      <div class="section-right">
        <div class="thechat">
          <div class="messages-outer">
            <div class="container messages" scrolltop.bind="scrollTop">
              <p repeat.for="msg of state.messages">
                <span class="stamp" title="${msg.fullStamp}" if.bind="msg.fullStamp">
                  ${msg.stamp}
                </span>
                <span class="username">[${msg.user || "anonymous"}]</span>&nbsp;
                <span class="body">${msg.body}</span>
              </p>
            </div>
          </div>
          <form role="form" submit.delegate="shout()">
            <input type="text" class="form-control chat-name"
              placeholder="name"
              value.bind="username">
            <input type="text" class="form-control chat-message"
              value.bind="message">
            <input type="submit" class="chat-submit">
          </form>
        </div>
      </div>

      <p class="clearer">&nbsp;</p>

    </div>
    <div class="content homebox">

      <div class="section-left">
        <h3>Upcoming Events</h3>
        <div class="events-listing small">
          <events-listing
            events.bind="state.latest_events"
            limit="3" showbtns="true">
          </events-listing>
          <p class="more">
            <a route-href="route: schedule">More</a>&nbsp;
            <i class="fa fa-long-arrow-right"></i>
          </p>
        </div>
      </div>

      <div class="section-right">
        <h3>Recent Episodes</h3>
        <div class="episodes-listing small">
          <episodes-listing episodes.bind="state.latest_episodes"
            limit="3" showbtns="true">
          </episodes-listing>
          <p class="more">
            <a route-href="route: podcast">More</a>&nbsp;
            <i class="fa fa-long-arrow-right"></i>
          </p>
        </div>
      </div>

      <p class="clearer">&nbsp;</p>

    </div>
  </div>

  </section>

</template>
